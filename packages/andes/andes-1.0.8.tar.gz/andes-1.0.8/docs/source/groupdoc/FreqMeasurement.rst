.. _FreqMeasurement:

================================================================================
FreqMeasurement
================================================================================
Frequency measurements.

Common Parameters: u, name

Available models:
BusFreq_,
BusROCOF_

.. _BusFreq:

--------------------------------------------------------------------------------
BusFreq
--------------------------------------------------------------------------------

Group FreqMeasurement_


    Bus frequency measurement.
    
Parameters

+-------+-------------+---------------------------------+---------+--------+-----------+------------+
| Name  |   Symbol    |           Description           | Default |  Unit  |   Type    | Properties |
+=======+=============+=================================+=========+========+===========+============+
|  idx  |             | unique device idx               |         |        | DataParam |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  u    | :math:`u`   | connection status               | 1       | *bool* | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  name |             | device name                     |         |        | DataParam |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  bus  |             | bus idx                         |         |        | IdxParam  | mandatory  |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  Tf   | :math:`T_f` | angle washout time constant     | 0.100   | *sec*  | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  Tw   | :math:`T_w` | lag time constant for frequency | 1       | *sec*  | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  fn   | :math:`f_n` | nominal frequency               | 60      |        | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+

Variables

+-------+------------------+------------------+------------------------------+------+------------+
| Name  |      Symbol      |  Initial Value   |         Description          | Unit | Properties |
+=======+==================+==================+==============================+======+============+
|  WO_x | :math:`x'_{WO}`  | :math:`\theta_d` | State in washout filter      |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  w    | :math:`\omega`   | :math:`1`        | frequency after output delay |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  ad   | :math:`\theta_d` | :math:`0`        | angle deviation              |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  WO_y | :math:`y_{WO}`   | :math:`0`        | Output of washout filter     |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  a    | :math:`\theta`   |                  |                              |      |            |
+-------+------------------+------------------+------------------------------+------+------------+
|  v    | :math:`V`        |                  |                              |      |            |
+-------+------------------+------------------+------------------------------+------+------------+

Differential Equations

+-------+-----------------+-------+---------------------------------------------+-------------+
| Name  |     Symbol      | Type  |      RHS of Equation "T x' = f(x, y)"       |   T (LHS)   |
+=======+=================+=======+=============================================+=============+
|  WO_x | :math:`x'_{WO}` | State | :math:`\theta_d - x'_{WO}`                  | :math:`T_f` |
+-------+-----------------+-------+---------------------------------------------+-------------+
|  w    | :math:`\omega`  | State | :math:`\frac{- \omega + y_{WO} + 1}{T_{w}}` |             |
+-------+-----------------+-------+---------------------------------------------+-------------+

Algebraic Equations

+-------+------------------+----------+-------------------------------------------------------------------+
| Name  |      Symbol      |   Type   |                   RHS of Equation "0 = g(x, y)"                   |
+=======+==================+==========+===================================================================+
|  ad   | :math:`\theta_d` | Algeb    | :math:`\theta - \theta_0 - \theta_d`                              |
+-------+------------------+----------+-------------------------------------------------------------------+
|  WO_y | :math:`y_{WO}`   | Algeb    | :math:`1/\omega_n \left(\theta_d - x'_{WO}\right) - T_{f} y_{WO}` |
+-------+------------------+----------+-------------------------------------------------------------------+
|  a    | :math:`\theta`   | ExtAlgeb | :math:`0`                                                         |
+-------+------------------+----------+-------------------------------------------------------------------+
|  v    | :math:`V`        | ExtAlgeb | :math:`0`                                                         |
+-------+------------------+----------+-------------------------------------------------------------------+

Services

+------+--------------------+-------------------------------+--------------+
| Name |       Symbol       |           Equation            |     Type     |
+======+====================+===============================+==============+
|  iwn | :math:`1/\omega_n` | :math:`\frac{u}{2 \pi f_{n}}` | ConstService |
+------+--------------------+-------------------------------+--------------+


.. _BusROCOF:

--------------------------------------------------------------------------------
BusROCOF
--------------------------------------------------------------------------------

Group FreqMeasurement_


    Bus frequency and ROCOF measurement.

    The ROCOF output variable is ``Wf_y``.
    
Parameters

+-------+-------------+---------------------------------+---------+--------+-----------+------------+
| Name  |   Symbol    |           Description           | Default |  Unit  |   Type    | Properties |
+=======+=============+=================================+=========+========+===========+============+
|  idx  |             | unique device idx               |         |        | DataParam |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  u    | :math:`u`   | connection status               | 1       | *bool* | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  name |             | device name                     |         |        | DataParam |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  bus  |             | bus idx                         |         |        | IdxParam  | mandatory  |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  Tf   | :math:`T_f` | angle washout time constant     | 0.100   | *sec*  | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  Tw   | :math:`T_w` | lag time constant for frequency | 1       | *sec*  | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  fn   | :math:`f_n` | nominal frequency               | 60      |        | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+
|  Tr   | :math:`T_r` | frequency washout time constant | 0.100   |        | NumParam  |            |
+-------+-------------+---------------------------------+---------+--------+-----------+------------+

Variables

+-------+------------------+------------------+------------------------------+------+------------+
| Name  |      Symbol      |  Initial Value   |         Description          | Unit | Properties |
+=======+==================+==================+==============================+======+============+
|  WO_x | :math:`x'_{WO}`  | :math:`\theta_d` | State in washout filter      |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  w    | :math:`\omega`   | :math:`1`        | frequency after output delay |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  Wf_x | :math:`x'_{Wf}`  | :math:`\omega`   | State in washout filter      |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  ad   | :math:`\theta_d` | :math:`0`        | angle deviation              |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  WO_y | :math:`y_{WO}`   | :math:`0`        | Output of washout filter     |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  Wf_y | :math:`y_{Wf}`   | :math:`0`        | Output of washout filter     |      | v_str      |
+-------+------------------+------------------+------------------------------+------+------------+
|  a    | :math:`\theta`   |                  |                              |      |            |
+-------+------------------+------------------+------------------------------+------+------------+
|  v    | :math:`V`        |                  |                              |      |            |
+-------+------------------+------------------+------------------------------+------+------------+

Differential Equations

+-------+-----------------+-------+---------------------------------------------+-------------+
| Name  |     Symbol      | Type  |      RHS of Equation "T x' = f(x, y)"       |   T (LHS)   |
+=======+=================+=======+=============================================+=============+
|  WO_x | :math:`x'_{WO}` | State | :math:`\theta_d - x'_{WO}`                  | :math:`T_f` |
+-------+-----------------+-------+---------------------------------------------+-------------+
|  w    | :math:`\omega`  | State | :math:`\frac{- \omega + y_{WO} + 1}{T_{w}}` |             |
+-------+-----------------+-------+---------------------------------------------+-------------+
|  Wf_x | :math:`x'_{Wf}` | State | :math:`\omega - x'_{Wf}`                    | :math:`T_r` |
+-------+-----------------+-------+---------------------------------------------+-------------+

Algebraic Equations

+-------+------------------+----------+-------------------------------------------------------------------+
| Name  |      Symbol      |   Type   |                   RHS of Equation "0 = g(x, y)"                   |
+=======+==================+==========+===================================================================+
|  ad   | :math:`\theta_d` | Algeb    | :math:`\theta - \theta_0 - \theta_d`                              |
+-------+------------------+----------+-------------------------------------------------------------------+
|  WO_y | :math:`y_{WO}`   | Algeb    | :math:`1/\omega_n \left(\theta_d - x'_{WO}\right) - T_{f} y_{WO}` |
+-------+------------------+----------+-------------------------------------------------------------------+
|  Wf_y | :math:`y_{Wf}`   | Algeb    | :math:`- T_{r} y_{Wf} + \omega - x'_{Wf}`                         |
+-------+------------------+----------+-------------------------------------------------------------------+
|  a    | :math:`\theta`   | ExtAlgeb | :math:`0`                                                         |
+-------+------------------+----------+-------------------------------------------------------------------+
|  v    | :math:`V`        | ExtAlgeb | :math:`0`                                                         |
+-------+------------------+----------+-------------------------------------------------------------------+

Services

+------+--------------------+-------------------------------+--------------+
| Name |       Symbol       |           Equation            |     Type     |
+======+====================+===============================+==============+
|  iwn | :math:`1/\omega_n` | :math:`\frac{u}{2 \pi f_{n}}` | ConstService |
+------+--------------------+-------------------------------+--------------+


