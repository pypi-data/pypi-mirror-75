{"version":3,"sources":["NavColumn.tsx","Common.ts","CentrePane.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["NavColumn","props","selectedBranch","className","css","styles","navColumn","ListGroup","selection","handleTestRun","selectedLeafID","NavBranchEntries","childBranchIDs","Object","keys","child_branches","map","short_id","childNode","ListGroupItem","key","getNavEntryStyle","status","navEntryCommon","navLabel","to","concat","encodeURIComponent","join","nodeid","NavLeafEntries","childLeafIDs","child_leaves","label","childLeaf","NavEntryIcon","icon","faRedo","spin","faPlay","onClick","e","stopPropagation","runButton","navEntryPassed","navEntryFailed","navEntryDefault","StyleSheet","create","height","width","position","padding","background","fontSize","cursor","color","transition","display","InfoPane","selectedLeaf","title","statusIcon","getStatusIcon","longrepr","message","Message","faCheckCircle","size","faTimesCircle","NavBreadcrumbs","numSelected","length","Breadcrumb","BreadcrumbItem","faHome","currSelected","restSelected","slice","index","flexDirection","justifyContent","alignItems","textAlign","minHeight","TestRunner","state","resultTree","loading","socket","errorMessage","handleUpdate","bind","io","this","setState","on","getResultTree","axios","get","then","response","data","catch","reason","String","console","log","root","updateResultTree","emit","parseSelection","url","getSelectedBranch","React","Component","trimmedPath","replace","split","decodeURIComponent","currRoot","updateData","newRoot","_","merge","TestRunnerDisplay","useQuery","centrePane","MessageDisplay","URLSearchParams","useLocation","search","reduce","node","App","path","render","location","pathname","Boolean","window","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.a9bb0e21.chunk.js","sourcesContent":["/**\n * Navigation column component and its subcomponents. Used to control navigation\n * from a current selected branch node down to its child nodes.\n */\nimport React from 'react';\nimport { ListGroup, ListGroupItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlay, faRedo } from '@fortawesome/free-solid-svg-icons';\nimport { Link } from \"react-router-dom\";\nimport { StyleSheet, css } from \"aphrodite\";\n\nimport { LIGHT_GREY, MEDIUM_GREY, COLWIDTH, BranchNode } from \"./Common\";\n\ninterface NavColumnProps {\n  selectedBranch: BranchNode | null,\n  selectedLeafID: string | null,\n  selection: Array<string>,\n  handleTestRun: (nodeid: string) => void,\n}\n\n/**\n * NavColumn component: renders the current navigation selection.\n * @param props Component props\n */\nexport const NavColumn = (props: NavColumnProps) => {\n  if (!props.selectedBranch) {\n    return <div className={css(styles.navColumn)} />;\n  }\n\n  return (\n    <div className={css(styles.navColumn)}>\n      <ListGroup>\n        <NavBranchEntries\n          selectedBranch={props.selectedBranch}\n          selection={props.selection}\n          handleTestRun={props.handleTestRun}\n        />\n        <NavLeafEntries\n          selectedBranch={props.selectedBranch}\n          handleTestRun={props.handleTestRun}\n          selectedLeafID={props.selectedLeafID}\n        />\n      </ListGroup>\n    </div>\n  );\n};\n\ninterface NavBranchEntriesProps {\n  selectedBranch: BranchNode,\n  selection: Array<string>,\n  handleTestRun: (nodeid: string) => void,\n}\n\n/**\n * Render entries in the nav column for branch nodes that are children of the\n * currently selected node.\n * @param props Render props\n */\nconst NavBranchEntries = (props: NavBranchEntriesProps) => {\n  const childBranchIDs = Object.keys(props.selectedBranch.child_branches);\n  return (\n    <>\n      {\n        childBranchIDs.map(\n          (short_id: string) => {\n            const childNode = props.selectedBranch.child_branches[short_id];\n\n            return (\n              <ListGroupItem\n                key={short_id}\n                className={\n                  css(\n                    getNavEntryStyle(childNode.status),\n                    styles.navEntryCommon,\n                  )\n                }\n              >\n                <span className={css(styles.navLabel)}>\n                  <Link\n                    to={\n                      props.selection\n                        .concat([short_id])\n                        .map(encodeURIComponent)\n                        .join(\"/\")\n                    }\n                  >\n                    {short_id}\n                  </Link>\n                </span>\n                <NavEntryIcon\n                  nodeid={childNode.nodeid}\n                  status={childNode.status}\n                  handleTestRun={props.handleTestRun}\n                />\n              </ListGroupItem>\n            );\n          }\n        )\n      }\n    </>\n  );\n};\n\ninterface NavLeafEntriesProps {\n  selectedBranch: BranchNode,\n  selectedLeafID: string | null,\n  handleTestRun: (nodeid: string) => void,\n}\n\n/**\n * Render entries in the navigation column for child leaves of the currently\n * selected node.\n * @param props Render props\n */\nconst NavLeafEntries = (props: NavLeafEntriesProps) => {\n  const childLeafIDs = Object.keys(props.selectedBranch.child_leaves);\n\n  return (\n    <>\n      {\n        childLeafIDs.map(\n          (short_id: string) => {\n            const label = (short_id === props.selectedLeafID) ?\n              short_id :\n              (\n                <Link\n                  to={`?selectedLeaf=${encodeURIComponent(short_id)}`}\n                >\n                  {short_id}\n                </Link>\n              );\n            const childLeaf = props.selectedBranch.child_leaves[short_id];\n\n            return (\n              <ListGroupItem\n                key={short_id}\n                className={\n                  css(\n                    getNavEntryStyle(\n                      props.selectedBranch.child_leaves[short_id].status\n                    ),\n                    styles.navEntryCommon,\n                  )\n                }\n              >\n                <span className={css(styles.navLabel)}>{label}</span>\n                <NavEntryIcon\n                  nodeid={childLeaf.nodeid}\n                  status={childLeaf.status}\n                  handleTestRun={props.handleTestRun}\n                />\n              </ListGroupItem>\n            );\n          }\n        )\n      }\n    </>\n  );\n};\n\ninterface NavEntryIconProps {\n  nodeid: string,\n  status: string,\n  handleTestRun: (nodeid: string) => void,\n}\n\nconst NavEntryIcon = (props: NavEntryIconProps) => {\n  switch (props.status) {\n    case \"running\":\n      return (\n        <FontAwesomeIcon\n          icon={faRedo}\n          spin\n        />\n      );\n\n    default:\n      return (\n        <FontAwesomeIcon\n          icon={faPlay}\n          onClick={(e: React.MouseEvent) => {\n            e.stopPropagation();\n            props.handleTestRun(props.nodeid);\n          }}\n          className={css(styles.runButton)}\n        />\n      );\n  }\n};\n\n/**\n * \n * @param status \n */\nconst getNavEntryStyle = (status: string) => {\n  switch (status) {\n    case \"passed\":\n      return styles.navEntryPassed;\n\n    case \"failed\":\n      return styles.navEntryFailed;\n\n    default:\n      return styles.navEntryDefault;\n  }\n}\n\nconst styles = StyleSheet.create({\n  navColumn: {\n    height: \"100%\",\n    width: COLWIDTH,\n    position: \"fixed\",\n    \"z-index\": 1,\n    \"top\": 0,\n    \"left\": 0,\n    \"overflow-x\": \"hidden\",\n    padding: \"20px\",\n    background: LIGHT_GREY,\n  },\n  navLabel: {\n    \"text-overflow\": \"ellipsis\",\n    \"white-space\": \"nowrap\",\n    fontSize: \"small\",\n    \"max-width\": \"90%\",\n  },\n  runButton: {\n    cursor: 'pointer',\n    color: 'black',\n    transition: 'all 0.3s ease-out 0s',\n    ':hover': {\n      color: LIGHT_GREY\n    }\n  },\n  navEntryPassed: { background: \"#c0ffbf\" },\n  navEntryFailed: { background: \"#ff7a7a\" },\n  navEntryDefault: { background: MEDIUM_GREY },\n  navEntryCommon: {\n    display: \"flex\",\n    \"justify-content\": \"space-between\",\n    \"align-items\": \"center\",\n  }\n});\n","/**\n * Global constants and type declarations.\n *\n * Commented out until used. \n */\n\n//const GREEN = '#228F1D';\n//const RED = '#A2000C';\n//const ORANGE = '#FFA500';\nexport const LIGHT_GREY = '#F3F3F3';\nexport const MEDIUM_GREY = '#D0D0D0';\n//const DARK_GREY = '#ADADAD';\n//const BLACK = '#404040';\n\nexport const COLWIDTH = \"25em\";\n\nexport interface BranchNode {\n  short_id: string,\n  nodeid: string,\n  status: string,\n  parent_ids: Array<string>,\n  child_branches: { [key: string]: BranchNode },\n  child_leaves: { [key: string]: LeafNode },\n}\n\nexport interface LeafNode {\n  short_id: string,\n  nodeid: string,\n  status: string,\n  parent_ids: Array<string>,\n  longrepr: string,\n}\n","/**\n * Contains InfoPane and NavBreadcrumbs components which make up the main\n * centre display pane.\n */\n\nimport React from 'react';\nimport { Breadcrumb, BreadcrumbItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faHome,\n  faCheckCircle,\n  faTimesCircle,\n} from '@fortawesome/free-solid-svg-icons';\nimport { Link } from \"react-router-dom\";\n\nimport { LeafNode, MEDIUM_GREY } from \"./Common\";\nimport { css, StyleSheet } from 'aphrodite';\n\ninterface InfoPaneProps {\n  selectedLeaf: LeafNode | null,\n}\n\n/**\n * InfoPane component: renders information on the currently selected testcase\n * (if any)\n * @param props Component props\n */\nexport const InfoPane = (props: InfoPaneProps) => {\n  if (!props.selectedLeaf) {\n    return <Message message=\"Please select a test.\" />;\n  }\n\n  return (\n    <>\n      <div>\n        <span className={css(styles.title)}>{props.selectedLeaf.nodeid}</span>\n        <span className={css(styles.statusIcon)}>\n          {getStatusIcon(props.selectedLeaf.status)}\n        </span>\n      </div>\n      <pre className={css(styles.longrepr)}>{props.selectedLeaf.longrepr}</pre>\n    </>\n  )\n}\n\ninterface MessageProps { message: string }\n\nexport const Message = (props: MessageProps) => (\n  <h1 className={css(styles.message)}>{props.message}</h1>\n);\n\n/**\n * Return an icon for the given test node status.\n * @param status Node status\n */\nconst getStatusIcon = (status: string) => {\n  switch (status) {\n    case \"passed\":\n      return (\n        <FontAwesomeIcon icon={faCheckCircle} color=\"green\" size=\"4x\" />\n      );\n\n    case \"failed\":\n      return (\n        <FontAwesomeIcon icon={faTimesCircle} color=\"red\" size=\"4x\" />\n      );\n\n    default:\n      return null;\n  }\n};\n\ninterface NavBreadcrumbsProps {\n  selection: Array<string>\n}\n\n/**\n* Navigation breadcrumb menu, used to show the current position in the test\n* tree and to navigate back up to any parent branch node.\n* @param props Render props\n*/\nexport const NavBreadcrumbs = (props: NavBreadcrumbsProps) => {\n  const numSelected = props.selection.length;\n\n  if (!numSelected) {\n    return (\n      <Breadcrumb>\n        <BreadcrumbItem key=\"home\">\n          <FontAwesomeIcon icon={faHome} />\n        </BreadcrumbItem>\n      </Breadcrumb>\n    );\n  }\n\n  const currSelected = props.selection[numSelected - 1];\n  const restSelected = props.selection.slice(0, numSelected - 1);\n\n  return (\n    <Breadcrumb>\n      <BreadcrumbItem key=\"home\">\n        <Link to=\"/\">\n          <FontAwesomeIcon icon={faHome} />\n        </Link>\n      </BreadcrumbItem>\n      {\n        restSelected.map(\n          (short_id: string, index: number) => (\n            <BreadcrumbItem key={short_id}>\n              <Link\n                to={\n                  \"/\" +\n                  props.selection\n                    .slice(0, index + 1)\n                    .map(encodeURIComponent)\n                    .join(\"/\")\n                }\n              >\n                {short_id}\n              </Link>\n            </BreadcrumbItem>\n          )\n        )\n      }\n      <BreadcrumbItem>{currSelected}</BreadcrumbItem>\n    </Breadcrumb>\n  );\n};\n\nconst styles = StyleSheet.create({\n  title: {\n    fontSize: \"large\",\n    \"font-weight\": \"bold\",\n    //\"width\": \"80%\",\n    //display: \"inline-block\",\n    \"text-overflow\": \"ellipsis\",\n    \"white-space\": \"nowrap\",\n    \"padding\": \"10px\",\n  },\n  statusIcon: {\n    \"float\": \"right\"\n  },\n  longrepr: {\n    \"padding\": \"10px\",\n  },\n  message: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    textAlign: 'center',\n    minHeight: '80vh',\n    color: MEDIUM_GREY,\n  }\n});","import React from 'react';\nimport axios from 'axios';\nimport io from 'socket.io-client';\nimport {\n  HashRouter as Router,\n  Route,\n  useLocation,\n} from \"react-router-dom\";\nimport { StyleSheet, css } from \"aphrodite\";\nimport _ from \"lodash\";\n\nimport { COLWIDTH, BranchNode } from \"./Common\";\nimport { NavColumn } from \"./NavColumn\";\nimport { NavBreadcrumbs, InfoPane, Message } from \"./CentrePane\";\n\n/**\n * Top level App component.\n */\nconst App = () => {\n  return (\n    <Router>\n      <Route path=\"/\"\n        render={\n          ({ location }) => {\n            return <TestRunner url={location.pathname} />;\n          }\n        }\n      />\n    </Router>\n  );\n};\n\ninterface TestRunnerProps {\n  url: string,\n}\n\ninterface TestRunnerState {\n  resultTree: BranchNode | null,\n  loading: boolean,\n  socket: SocketIOClient.Socket | null,\n  errorMessage: string | null,\n}\n\nclass TestRunner extends React.Component<TestRunnerProps, TestRunnerState> {\n  constructor(props: TestRunnerProps) {\n    super(props);\n    this.state = {\n      resultTree: null,\n      loading: false,\n      socket: null,\n      errorMessage: null,\n    }\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleTestRun = this.handleTestRun.bind(this);\n  }\n\n  /**\n   * When the component mounts, we initiate the websocket connection and\n   * make an API call to get the result tree.\n   */\n  componentDidMount() {\n    const socket = io();\n    this.setState({ loading: true, socket: socket }, () => {\n      socket.on('update', this.handleUpdate);\n      this.getResultTree();\n    });\n  }\n\n  /**\n   * Make an API call to get the result tree data. Called at start of day when\n   * this component mounts, then further updates are handled by the websocket\n   * connection.\n   */\n  getResultTree() {\n    axios.get(\"/api/v1/result-tree\").then(response => {\n      this.setState({ resultTree: response.data, loading: false });\n    }).catch((reason: any) => {\n      this.setState({ loading: false, errorMessage: String(reason) });\n    });\n  }\n\n  /**\n   * Handle an update event received over a websocket.\n   * @param data Update data received over socket\n   */\n  handleUpdate(data: BranchNode) {\n    console.log(\"Handling websocket update\");\n    console.log(data);\n\n    const root = this.state.resultTree;\n    if (!root) {\n      return;\n    }\n\n    this.setState((state) => {\n      const newTree = updateResultTree(root, data);\n      return { resultTree: newTree };\n    });\n  }\n\n  /**\n   * Run a test after its run button has been clicked.\n   * @param short_id ID of node to run\n   */\n  handleTestRun(nodeid: string) {\n    if (!this.state.socket) {\n      console.log(\"Socket connection not yet established\");\n      return;\n    }\n    this.state.socket.emit(\"run test\", nodeid);\n  }\n\n  /**\n   * Render the test runner UI. Currently this component acts as the stateful\n   * store and hands off rendering logic to a separate stateless component.\n   */\n  render() {\n    const selection = parseSelection(this.props.url);\n\n    if (this.state.loading) {\n      return <MessageDisplay message=\"Loading...\" selection={selection} />;\n    }\n\n    if (this.state.errorMessage) {\n      return (\n        <MessageDisplay\n          message={this.state.errorMessage}\n          selection={selection}\n        />\n      );\n    }\n\n    const selectedBranch = getSelectedBranch(\n      selection,\n      this.state.resultTree,\n    );\n\n    if (!selectedBranch) {\n      return <MessageDisplay message=\"404 Page Not Found\" selection={selection} />;\n    }\n\n    return (\n      <TestRunnerDisplay\n        selectedBranch={selectedBranch}\n        selection={selection}\n        handleTestRun={this.handleTestRun}\n      />\n    );\n  }\n}\n\n/**\n * Parse the current URL path (excluding query parameters) and return the\n * short_ids of the currently selected branches.\n * @param url URL path string\n */\nconst parseSelection = (url: string): Array<string> => {\n  const trimmedPath = url.replace(/^\\/+|\\/+$/g, '');\n  if (trimmedPath.length === 0) {\n    return [];\n  }\n  const pathElements = trimmedPath.split(\"/\");\n  return pathElements.map(decodeURIComponent);\n};\n\n/**\n * Update a particular node in the result tree with new data.\n * @param currNode Existing in result tree to update\n * @param updateData Update data for new node\n */\nconst updateResultTree = (\n  currRoot: BranchNode, updateData: BranchNode\n): BranchNode => {\n  const newRoot = { ...currRoot };\n  _.merge(newRoot, updateData);\n  return newRoot;\n};\n\ninterface TestRunnerDisplayProps {\n  selectedBranch: BranchNode | null,\n  selection: Array<string>,\n  handleTestRun: (short_id: string) => void,\n}\n\n/**\n * Render the navigation column, top breadcrumb menu and the central information\n * pane together.\n * @param props render properties\n */\nconst TestRunnerDisplay = (props: TestRunnerDisplayProps) => {\n  const query = useQuery();\n  const selectedLeafID = query.get(\"selectedLeaf\");\n  const selectedLeaf = (selectedLeafID && props.selectedBranch) ?\n    props.selectedBranch.child_leaves[selectedLeafID] : null;\n\n  return (\n    <div>\n      <NavColumn\n        selectedBranch={props.selectedBranch}\n        selectedLeafID={selectedLeafID}\n        selection={props.selection}\n        handleTestRun={props.handleTestRun}\n      />\n      <div className={css(styles.centrePane)}>\n        <NavBreadcrumbs selection={props.selection} />\n        <InfoPane selectedLeaf={selectedLeaf} />\n      </div>\n    </div>\n  );\n};\n\ninterface MessageDisplayProps {\n  message: string,\n  selection: Array<string>,\n}\n\n/**\n * Display a message.\n */\nconst MessageDisplay = (props: MessageDisplayProps) => (\n  <div>\n    <NavColumn\n      selectedBranch={null}\n      selectedLeafID={null}\n      selection={[]}\n      handleTestRun={(nodeid: string) => undefined}\n    />\n    <div className={css(styles.centrePane)}>\n      <NavBreadcrumbs selection={props.selection} />\n      <Message message={props.message} />\n    </div>\n  </div>\n);\n\n/**\n * Modified react hook to parse the current query parameters in the URL. These\n * are expected in the form \"?x=y\".\n */\nconst useQuery = () => new URLSearchParams(useLocation().search);\n\n/**\n * Get the currently selected branch node, or null if the result tree is not yet\n * loaded.\n * @param state App state\n */\nconst getSelectedBranch = (\n  selection: Array<string>, resultTree: BranchNode | null\n) => {\n  if (resultTree) {\n    const selectedBranch = selection.reduce(\n      (node: BranchNode | undefined, selection: string) => (\n        node?.child_branches[selection]\n      ),\n      resultTree,\n    );\n    if (selectedBranch) {\n      return selectedBranch;\n    } else {\n      console.log(selection);\n      return null;\n    }\n  } else {\n    return null;\n  }\n};\n\nconst styles = StyleSheet.create({\n  centrePane: {\n    \"margin-left\": COLWIDTH,\n    padding: \"10px 10px\",\n  },\n});\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}